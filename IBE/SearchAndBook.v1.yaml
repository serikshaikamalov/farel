openapi: 3.0.0
info:
  title: booking
  version: '1.0'
  description: Booking management
  contact:
    name: Asset Yelemessov
    url: farel.dev
    email: asset@farel.io
servers:
  - url: 'http://localhost:8080/api/v1'
tags:
  - name: Search flights
    description: Paginated list of Bookings
  - name: Create booking
paths:
  /public/flights:
    get:
      operationId: search-flights
      description: search flights by given search criteria
      tags:
        - Search flights
      parameters:
        - name: origin
          in: query
          required: true
          schema:
            type: string
          description: Origin Airport Code
          example: NQZ
        - name: destination
          in: query
          required: true
          schema:
            type: string
          description: Destination Airport Code
          example: ALA
        - name: outboundDate
          in: query
          required: true
          schema:
            type: string
            format: date
          example: '2020-01-01'
          description: Flight date in the format defined by ISO
        - name: returnDate
          in: query
          required: true
          schema:
            type: string
            enum:
              - OW
              - RT
          description: One-Way vs. Round-Trip indicator
          example: OW
        - name: airlines
          in: query
          required: true
          schema:
            type: array
            items:
              type: string
            minItems: 1
          description: Airline IDs
      responses:
        '200':
          description: List of flights
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FlightsResponse'
  /public/bookings:
    post:
      operationId: create-booking
      description: Create booking
      tags:
        - Create booking
      requestBody:
        $ref: '#/components/requestBodies/BookingRequestBody'
      responses:
        '204':
          description: Booking was created successfully
  /public/fares:
    get:
      operationId: get-fares
      description: Get Fares for the given flights and dates
      tags:
        - Get Fares
      parameters:
        - name: flights
          in: query
          schema:
            type: array
            items:
              properties:
                flightNumber:
                  type: string
                flightDate:
                  type: string
                  format: datetime
                tripType:
                  type: string
                  enum:
                    - OW
                    - RT
      responses:
        '200':
          description: List of Fares
          content:
            application/json:
              schema:
                type: array
                items:
                  properties:
                    flightNumber:
                      type: string
                    flightDate:
                      type: string
                      format: datetime
                    passengerType:
                      type: string
                    baseFare:
                      type: number
                    totalPrice:
                      type: number
                    fees:
                      type: array
                      items:
                        properties:
                          name:
                            type: string
                          amount:
                            type: number
  requestBodies:
    BookingRequestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            properties:
              flights:
                type: array
                items:
                  properties:
                    flightNumber:
                      type: string
                    flightDate:
                      type: string
                      format: datetime
              passengers:
                type: array
                items:
                  properties:
                    passengerType:
                      type: string
                      example: ADT
                    firstname:
                      type: string
                    lastname:
                      type: string
                    gender:
                      type: string
                    birthday:
                      type: string
                      format: date
                    citizenship:
                      type: string
                      example: KZ
                    documentId:
                      type: string
                    documentExpireDate:
                      type: string
                      format: datetime
                    fareClassCode:
                      type: string
                      example: 'Y'
              contactPerson:
                type: object
                properties:
                  firstname:
                    type: string
                  lastname:
                    type: string
                  email:
                    type: string
                  phone:
                    type: string
  schemas:
    FlightsResponse:
      type: object
      properties:
        totalCount:
          type: integer
        data:
          type: array
          items:
            $ref: '#/components/schemas/Flight'
    Flight:
      type: object
      properties:
        origin:
          type: string
          example: ALA
        destination:
          type: string
          example: SVO
        departTime:
          type: string
          pattern: 'HH:MM'
        arriveTime:
          type: string
          pattern: 'HH:MM'
        arriveDateOffset:
          type: string
          example: '-1'
        duration:
          type: integer
          description: Flight duration in minutes
          example: 120
        stops:
          type: array
          items:
            properties:
              airport:
                type: string
                example: NQZ
              stopDuration:
                type: integer
                description: Stop duration in minutes
                example: 60
        flightSegments:
          type: array
          items:
            properties:
              flightNumber:
                type: string
              aircraft:
                type: string
              flightDuration:
                type: integer
              stopDuration:
                type: integer
              origin:
                type: object
                properties:
                  city:
                    type: string
                  airportName:
                    type: string
                  airportCode:
                    type: string
                  date:
                    type: string
                    format: datetime
                  time:
                    type: string
                    pattern: 'HH:MM'
              destination:
                type: object
                properties:
                  city:
                    type: string
                  airportName:
                    type: string
                  airportCode:
                    type: string
                  date:
                    type: string
                    format: date
                  time:
                    type: string
                    pattern: 'HH:MM'
        totalPrice:
          type: string
          example: $500
  responses: {}
components:
  schemas:
    FlightsResponse:
      title: FlightsResponse
      type: object
      properties:
        outboundFlights:
          type: array
          items:
            type: object
            properties:
              origin:
                type: string
              destination:
                type: string
              departTime:
                type: string
              arriveTime:
                type: string
              arriveDateOffset:
                type: string
              duration:
                type: integer
              totalPrice:
                type: number
              stops:
                type: array
                items:
                  type: object
                  properties:
                    airport:
                      type: string
                    stopDuration:
                      type: number
              flightSegments:
                type: array
                items:
                  type: object
                  properties:
                    flightNumber:
                      type: string
                    aircraft:
                      type: string
                    flightDuration:
                      type: integer
                    stopDuration:
                      type: number
                    origin:
                      type: object
                      properties:
                        city:
                          type: string
                        airportName:
                          type: string
                        airportCode:
                          type: string
                        date:
                          type: string
                        time:
                          type: string
                    destination:
                      type: object
                      properties:
                        city:
                          type: string
                        airportName:
                          type: string
                        airportCode:
                          type: string
                        date:
                          type: string
                        time:
                          type: string
                    fees:
                      type: array
                      items:
                        type: object
                        properties:
                          flightNumber:
                            type: string
                          cabinClass:
                            type: string
                          date:
                            type: string
                            format: datetime
                          passengerType:
                            type: string
                          fareClasses:
                            type: array
                            items:
                              type: object
                              properties:
                                id:
                                  type: integer
                                baggage:
                                  type: integer
                                cabinBaggage:
                                  type: integer
                                fare:
                                  type: integer
                                flightId:
                                  type: integer
                                refundable:
                                  type: boolean
                                refundPenalty:
                                  type: number
                                totalPrice:
                                  type: number
                                fareClassCode:
                                  type: string
                                fareClass:
                                  type: string
                                code:
                                  type: string
                                fees:
                                  type: array
                                  items:
                                    type: object
                                    properties:
                                      id:
                                        type: integer
                                      tax:
                                        type: string
                                      type:
                                        type: string
                                      amount:
                                        type: number
        returnFlights:
          type: array
          items:
            type: object
            properties:
              origin:
                type: string
              destination:
                type: string
              departTime:
                type: string
              arriveTime:
                type: string
              arriveDateOffset:
                type: string
              duration:
                type: integer
              totalPrice:
                type: number
              stops:
                type: array
                items:
                  type: object
                  properties:
                    airport:
                      type: string
                    stopDuration:
                      type: number
              flightSegments:
                type: array
                items:
                  type: object
                  properties:
                    flightNumber:
                      type: string
                    aircraft:
                      type: string
                    flightDuration:
                      type: integer
                    stopDuration:
                      type: number
                    origin:
                      type: object
                      properties:
                        city:
                          type: string
                        airportName:
                          type: string
                        airportCode:
                          type: string
                        date:
                          type: string
                        time:
                          type: string
                    destination:
                      type: object
                      properties:
                        city:
                          type: string
                        airportName:
                          type: string
                        airportCode:
                          type: string
                        date:
                          type: string
                        time:
                          type: string
                    fees:
                      type: array
                      items:
                        type: object
                        properties:
                          flightNumber:
                            type: string
                          cabinClass:
                            type: string
                          date:
                            type: string
                            format: datetime
                          passengerType:
                            type: string
                          fareClasses:
                            type: array
                            items:
                              type: object
                              properties:
                                id:
                                  type: integer
                                baggage:
                                  type: integer
                                cabinBaggage:
                                  type: integer
                                fare:
                                  type: integer
                                flightId:
                                  type: integer
                                refundable:
                                  type: boolean
                                refundPenalty:
                                  type: number
                                totalPrice:
                                  type: number
                                fareClassCode:
                                  type: string
                                fareClass:
                                  type: string
                                code:
                                  type: string
                                fees:
                                  type: array
                                  items:
                                    type: object
                                    properties:
                                      id:
                                        type: integer
                                      tax:
                                        type: string
                                      type:
                                        type: string
                                      amount:
                                        type: number
      description: ''
